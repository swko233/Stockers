<%= stylesheet_link_tag 'users/show_following', :media => "all" %>

<div class="container">
	<section class="user-profile">
		<div class="profile-main">
			<div class="icon-box">
				<%= attachment_image_tag @user, :image,fallback: "no_user_image", format: "png", class: "icon" %>
			</div>
			<div class="user-info">
				<div class="user-name">
					<p class="name"><%= @user.name %></p>
					<p class="nickname">@<%= @user.nickname %></p>
				</div>
				<div class="links">
					<section class="stats">
						<%= render 'stats' %>
					</section>
				</div>
			</div>
		<div class="profile-sub">
		</div>
	</section>
	<div class="user-list-box">
		<% @user.following.each do |user| %>
			<div class="user-box">
				<%= link_to user_path(user.id) do %>
					<div class="follow-user-profile">
						<div class="icon-box">
							<%= attachment_image_tag user, :image,fallback: "no_user_image", format: "png", class: "icon" %>
						</div>
						<div class="user-name">
							<p class="name"><%= user.name %></p>
							<p class="nickname">@<%= user.nickname %></p>
						</div>
					</div>
				<% end %>
				<% unless user == current_user %>
					<div id="follow_form_<%= user.id %>">
						<% if current_user.following?(user) %>
							<%= form_for(current_user.following_relationships.find_by(following_id: user.id), html: {method: :delete}, remote: true) do |f| %>
								<%= f.submit 'フォロー中', class: "btn btn-primary btn-following" %>
							<% end %>
						<% else %>
							<%= form_for(current_user.following_relationships.build, remote: true) do |f| %>
								<div><%= hidden_field_tag :following_id, user.id %></div>
								<%= f.submit 'フォローする', class: "btn btn-primary btn-follow" %>
							<% end %>
						<% end %>
					</div>
				<% end %>
			</div>
		<% end %>
	</div>
</div>